import { AbrigoAnimais } from "./abrigo-animais.js";

// Fun√ß√£o helper para executar testes
function executarTeste(nome, esperado, obtido) {
  const passou = JSON.stringify(esperado) === JSON.stringify(obtido);
  console.log(`${passou ? "‚úÖ" : "‚ùå"} ${nome}`);

  if (!passou) {
    console.log("  Esperado:", JSON.stringify(esperado, null, 2));
    console.log("  Obtido:", JSON.stringify(obtido, null, 2));
  }

  return passou;
}

console.log("üß™ Executando Testes do Abrigo de Animais\n");

const abrigo = new AbrigoAnimais();
let testesPassaram = 0;
let totalTestes = 0;

// Teste 1: Exemplo do desafio - caso v√°lido
totalTestes++;
const teste1 = abrigo.encontraPessoas("RATO,BOLA", "RATO,NOVELO", "Rex,Fofo");
const esperado1 = { lista: ["Fofo - abrigo", "Rex - pessoa 1"] };
if (executarTeste("Exemplo v√°lido do desafio", esperado1, teste1))
  testesPassaram++;

// Teste 2: Exemplo do desafio - animal inv√°lido
totalTestes++;
const teste2 = abrigo.encontraPessoas("CAIXA,RATO", "RATO,BOLA", "Lulu");
const esperado2 = { erro: "Animal inv√°lido" };
if (executarTeste("Animal inv√°lido", esperado2, teste2)) testesPassaram++;

// Teste 3: Brinquedo inv√°lido
totalTestes++;
const teste3 = abrigo.encontraPessoas("RATO,UNICORNIO", "BOLA,LASER", "Rex");
const esperado3 = { erro: "Brinquedo inv√°lido" };
if (executarTeste("Brinquedo inv√°lido", esperado3, teste3)) testesPassaram++;

// Teste 4: Animal duplicado
totalTestes++;
const teste4 = abrigo.encontraPessoas("RATO,BOLA", "LASER", "Rex,Rex");
const esperado4 = { erro: "Animal inv√°lido" };
if (executarTeste("Animal duplicado", esperado4, teste4)) testesPassaram++;

// Teste 5: Brinquedo duplicado
totalTestes++;
const teste5 = abrigo.encontraPessoas("RATO,RATO", "LASER", "Rex");
const esperado5 = { erro: "Brinquedo inv√°lido" };
if (executarTeste("Brinquedo duplicado", esperado5, teste5)) testesPassaram++;

// Teste 6: Ambas pessoas podem adotar (regra 4)
totalTestes++;
const teste6 = abrigo.encontraPessoas("RATO,BOLA", "RATO,BOLA", "Rex");
const esperado6 = { lista: ["Rex - abrigo"] };
if (executarTeste("Ambas pessoas podem adotar", esperado6, teste6))
  testesPassaram++;

// Teste 7: Ordem alfab√©tica
totalTestes++;
const teste7 = abrigo.encontraPessoas("RATO,BOLA", "LASER", "Zero,Bebe,Rex");
if (
  executarTeste(
    "Resultado em ordem alfab√©tica",
    true,
    teste7.lista &&
      teste7.lista[0] < teste7.lista[1] &&
      teste7.lista[1] < teste7.lista[2]
  )
)
  testesPassaram++;

// Teste 8: Loco com companhia
totalTestes++;
const teste8 = abrigo.encontraPessoas("RATO,SKATE", "BOLA", "Loco,Rex");
// Loco deve ir para pessoa 1 porque tem companhia e a pessoa tem seus brinquedos
if (teste8.lista) {
  const locoResult = teste8.lista.find((r) => r.startsWith("Loco"));
  if (
    executarTeste(
      "Loco com companhia",
      true,
      locoResult && locoResult.includes("pessoa")
    )
  )
    testesPassaram++;
} else {
  totalTestes--; // N√£o contar este teste se houver erro
}

// Resumo dos testes
console.log("\n" + "=".repeat(50));
console.log(`üìä Resumo: ${testesPassaram}/${totalTestes} testes passaram`);

if (testesPassaram === totalTestes) {
  console.log(
    "üéâ Todos os testes passaram! C√≥digo est√° funcionando corretamente."
  );
} else {
  console.log("‚ö†Ô∏è  Alguns testes falharam. Verifique a implementa√ß√£o.");
}
